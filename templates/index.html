{% extends "layout.html" %}

{% block title %}Mapa de Población por Cantones{% endblock %}

{% block content %}
  <div id="map">{{ mapa|safe }}</div>
  
  <!-- Leyenda de colores del mapa -->
  <div id="map-legend">
    <div id="map-legend-header">
      <i class="fas fa-palette"></i> Densidad de Población
      <button id="toggle-legend" title="Minimizar/Maximizar">−</button>
    </div>
    <div id="map-legend-content">
      <div class="legend-section">
        <div class="legend-item">
          <div class="legend-color" style="background-color: #0066cc; opacity: 0.3;"></div>
          <div class="legend-label">Muy baja (&lt; 5 hab/km²)</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background-color: #00aa44; opacity: 0.4;"></div>
          <div class="legend-label">Baja (5 - 25 hab/km²)</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background-color: #88dd00; opacity: 0.5;"></div>
          <div class="legend-label">Moderada (25 - 100 hab/km²)</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background-color: #ffff00; opacity: 0.6;"></div>
          <div class="legend-label">Media (100 - 500 hab/km²)</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background-color: #ffaa00; opacity: 0.7;"></div>
          <div class="legend-label">Alta (500 - 1,500 hab/km²)</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background-color: #ff5500; opacity: 0.8;"></div>
          <div class="legend-label">Muy alta (1,500 - 5,000 hab/km²)</div>
        </div>
        <div class="legend-item">
          <div class="legend-color" style="background-color: #cc0000; opacity: 0.9;"></div>
          <div class="legend-label">Extrema (&gt; 5,000 hab/km²)</div>
        </div>
      </div>
    </div>
  </div>
  
  <!-- Tabla de población por cantón -->
  <div id="population-table-container">
    <div id="population-table-header">
      <h6><i class="fas fa-chart-bar"></i> Población por Cantón</h6>
      <button id="toggle-table" title="Minimizar/Maximizar">−</button>
    </div>
    <div id="population-table-content">
      <div id="population-table-loading">
        <div class="spinner-border spinner-border-sm text-primary" role="status">
          <span class="sr-only">Cargando...</span>
        </div>
        <span class="ml-2">Calculando población...</span>
      </div>
      <table id="population-table" class="table table-sm table-hover" style="display: none;">
        <thead>
          <tr>
            <th style="width: 40px;">#</th>
            <th>Cantón</th>
            <th style="width: 80px; text-align: right;">Habitantes</th>
          </tr>
        </thead>
        <tbody id="population-table-body">
        </tbody>
      </table>
    </div>
  </div>
{% endblock %}
